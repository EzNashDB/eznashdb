{% extends "account/base.html" %}

{% load crispy_forms_tags %}

{% block title %}Manage Email - The Ezrat Nashim Database{% endblock %}

{% block account_content %}
    {% if user.is_authenticated %}
        {% if emailaddresses %}
            {% for emailaddress in emailaddresses %}
                {% if not emailaddress.verified %}
                    <h2 class="mb-4">Verify Your Email</h2>
                    <div class="alert alert-warning">
                        <i class="fa-solid fa-triangle-exclamation me-2"></i>
                        <strong>Your email address is not verified.</strong>
                    </div>
                    <p>
                        Email address: <strong>{{ user.email }}</strong>
                    </p>
                    <p>
                        To enable password reset, please verify your email address.
                        We'll send you a verification link - just click it to confirm.
                    </p>
                    <form method="post" action="{% url 'account_email' %}" class="mt-3">
                        {% csrf_token %}
                        <input type="hidden" name="email" value="{{ emailaddress.email }}">
                        <button type="submit" name="action_send" class="btn btn-primary">
                            <i class="fa-solid fa-envelope me-2"></i>Send Verification Email
                        </button>
                    </form>
                {% else %}
                    <h2 class="mb-4">Email Address</h2>
                    <div class="alert alert-success">
                        <i class="fa-solid fa-circle-check me-2"></i>
                        <strong>Your email address is verified.</strong>
                    </div>
                    <p>
                        Email address: <strong>{{ user.email }}</strong>
                    </p>
                {% endif %}
            {% endfor %}
        {% endif %}
        <div class="mt-3">
            <a href="{% url 'account_settings' %}" class="btn btn-outline-secondary">Back to Settings</a>
        </div>
    {% else %}
        <p>You must be logged in to manage your email addresses.</p>
        <div class="mt-3">
            <a href="{% url 'account_login' %}" class="btn btn-primary">Log In</a>
        </div>
    {% endif %}
{% endblock %}
