{% extends "account/base.html" %}

{% load crispy_forms_tags %}

{% block title %}Manage Email - The Ezrat Nashim Database{% endblock %}

{% block account_content %}
    <h2 class="mb-4">Email Address</h2>
    {% if user.is_authenticated %}
        <p>
            Your email address: <strong>{{ user.email }}</strong>
        </p>
        {% if emailaddress_set %}
            {% for emailaddress in emailaddress_set %}
                {% if not emailaddress.verified %}
                    <div class="alert alert-warning mt-3">
                        <i class="fa-solid fa-triangle-exclamation me-2"></i>
                        Your email address is not verified.
                        <form method="post" action="{% url 'account_email' %}" class="d-inline">
                            {% csrf_token %}
                            <input type="hidden" name="action_send" value="{{ emailaddress.id }}">
                            <button type="submit" class="btn btn-sm btn-warning">Resend Verification Email</button>
                        </form>
                    </div>
                {% else %}
                    <div class="alert alert-success mt-3">
                        <i class="fa-solid fa-circle-check me-2"></i>
                        Your email address is verified.
                    </div>
                {% endif %}
            {% endfor %}
        {% endif %}
        <div class="mt-3">
            <a href="/" class="btn btn-outline-secondary">Back to Home</a>
        </div>
    {% else %}
        <p>You must be logged in to manage your email addresses.</p>
        <div class="mt-3">
            <a href="{% url 'account_login' %}" class="btn btn-primary">Log In</a>
        </div>
    {% endif %}
{% endblock %}
